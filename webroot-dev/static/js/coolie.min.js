/*!
 * coolie 苦力
 * @author ydr.me
 * @version 0.13.0
 * @license MIT
 */
!function(e){"use strict";var t="0.13.0",n={};n.version=t;var r,o=function(){return(new Date).getTime()},i=0,u=e.document,c={},a=[],s=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},l=function(e){return"array"===s(e)},f=function(e){return"function"===s(e)},d=function(e){return"string"===s(e)},p=function(e,t,n){var r,o;if(l(e))for(r=n?e.length-1:0,o=n?0:e.length;(n?r>o:o>r)&&t(r,e[r])!==!1;n?r--:r++);else if("object"==typeof e)for(r in e)if(t(r,e[r])===!1)break},h=function(){var t={},n=e.console,r=["log","warn","group","groupEnd"];return p(r,function(e,r){t[r]=function(){if(c.debug&&n&&n[r])try{n[r].apply(n,arguments)}catch(e){}}}),t}(),v=/\/[^/]+$/,g=/^((ftp|file|https?):)?\/\/[^\/]*/,m=/^\/\//,_=function(e,t){return e=e.replace(g,""),"/"===e?e:v.test(e)?t?e+"/":e.replace(v,"/"):e},y=/^\/|((http|ftp)s?:\/\/)/,x=/^(\.{1,2})\//,b=/(\/[^/]+?)?\/$/,j=function(e,t){if(!t||y.test(t))return t;var n;for(t="./"+t;n=t.match(x);)t=t.replace(x,""),2===n[1].length&&(e=e.replace(b,"/"));return e+t},w=function(e,t){return(t||u).getElementsByTagName(e)},A=/[\?#].*?$/,S=/\.js($|\?)/i,$=function(e,t){return e=e.replace(A,""),t?e:(b.test(e)&&(e+="index"),e+(S.test(e)?"":".js"))},q=function(e){return $(e.hasAttribute?e.src:e.getAttribute("src",4))},E=function(e,t){return e.getAttribute("data-"+t)},C=/loaded|complete/,L=u.head||w("head",u)[0],k=w("base",L)[0],T=/\.[^.]*$/,B=function(e){if(!c._v)return e;var t=d(c._v)?c._v:c._v[e];return t?e.replace(T,"."+t+"$&"):e},D=null,J=function(t,n){var o=B(t),i=u.createElement("script"),c=!1,a=function(e){if(!c){if(c=!0,e&&"error"===e.type)throw"load script error\n"+o;n!==!0&&(D=i,lt(i)),L.removeChild(i),i=null}};i.src=o,i.id=t,i.async=!0,i.defer=!0,i.onload!==r?i.onload=i.onerror=a:i.onreadystatechange=function(t){C.test(i.readyState)&&(t=t||e.event,a(t))},k?L.insertBefore(i,k):L.appendChild(i)},R=function(e,t){var n={};try{n=JSON.parse(t)}catch(r){try{var o=new Function("","return "+t);n=o()}catch(i){throw"parse json error "+e}}return n},U=function(e,t){var n,r=B(e),o=new XMLHttpRequest,i=function(){if(4===o.readyState&&!n){if(n=!0,200!==o.status&&304!==o.status)throw"ajax error\n"+r;ft({_isAn:Y._isAn,id:e,url:r,deps:[],factory:function(){var n=o.responseText;return n&&"json"===t&&(n=R(e,n)),n}})}};o.onload=o.onreadystatechange=o.onerror=o.onabort=o.ontimeout=i,o.open("GET",r),o.send(null)},G=function(e){ft({_isAn:Y._isAn,id:e,url:B(e),deps:[],factory:function(){return e}})},H=function(){var e=w("script");return e[e.length-1]},M=H(),N=function(e){return m.test(e)&&(e=location.protocol+e),(e.match(g)||[])[0]},O=n.coolieJSURL=q(M),P=N(O),F=E(M,"config"),X=E(M,"main"),z=_(O),I=F?j(z,F):null,K=F?_(I):null,Q=F?j(P,I):null,V=function(){if(!F)return null;var e=N(Q);return e?e:(e=P,Q=e+Q,e)}(),W=K,Y={},Z=!1,et={},tt=[],nt={},rt=1,ot=0;n.config=function(t){if(c=t,c.version=c.version||{},Q?W=j(K,_(c.base,!0)):(V=N(t.base),W=_(t.base)),d(c.version)?c._v=c.version:(c._v={},p(c.version,function(e,t){c._v[V+j(W,e)]=t})),X){var r=Y.url=$(V+j(W,X));Y._dfn=!1,et[r]=Y}return e.DEBUG=t.debug=t.debug!==!1,n},n.use=function(e){return Z?n:(Z=!0,i=o(),e&&(Y.url=V+j(W,e),et[Y.url]=Y),Y.url?(J(Y.url),h.group("coolie modules"),n):n)},n.callback=function(e){return Y._executed&&f(e)?(e.call(n,Y.exports),n):(f(e)&&a.push(e),n)};var it=/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|\/\*[\S\s]*?\*\/|\/(?:\\\/|[^\/\r\n])+\/(?=[^\/])|\/\/.*|\.\s*require|(?:^|[^$])\brequire\s*\(\s*(["'])(.+?)\1\s*\)/g,ut=/\\\\/g,ct=/([^"']+)(?:['"]\s*?,\s*?['"]([^'"]*))?/,at={image:"image",text:"text",html:"text",json:"json",css:"text"},st=function(e){var t=[];return e.replace(ut,"").replace(it,function(e,n,r){if(r){var o=r.match(ct),i={name:$(o[1],!!o[2]),type:o[2]?at[o[2].toLowerCase()]:"js"};t.push(i)}}),t},lt=function(e){var t=!0,n=tt.shift();if(!n)throw"can not parse module "+(D?D.src:"undefined");var r=n[0],o=n[1],i=n[2],u=e.id,c=q(e),a=_(u);f(n[2])?t=!1:f(n[1])?(r=null,o=[],i=n[1]):f(n[0])&&(i=n[0],o=st(i.toString()),r=null),r=Y._dfn&&Y._isAn?u:r||u;var s={_isAn:t,_path:a,_node:e,id:r,url:c,deps:o,factory:i};Y.id||(t||(et[r]=et[Y.url]),s._isMain=!0,Y=s,Y._dfn=!0);var l=[];p(o,function(e,t){if(d(t)&&(t={id:t}),Y._isAn){var n=j(a,t.name);t.id=$(V+n,"js"!==t.type)}if(r===t.id)throw"required myself: \n"+r;if(nt[t.id]&&p(nt[t.id].deps,function(e,t){if(t===r)throw"required circle: \n"+t+"\n"+r}),!et[t.id]&&(l.push(t.id),et[t.id]=!0,rt++,Y._isAn))switch(t.type){case"text":case"json":U(t.id,t.type);break;case"image":G(t.id);break;default:J(t.id)}}),s.deps=l,ft(s),tt.length&&lt(D)},ft=function(t){t.exports={},t._execute=function(){var n=function(e,n){var r;if(Y._isAn&&(r={name:e,type:n||"js"},e=V+$(j(t._path,r.name),"js"!==r.type)),!nt[e])throw"can not found module \n"+e+"\nbut required in\n"+t.id;return nt[e]._execute()};return function(){var r=t.id;return t._executed?nt[r].exports:(t._executed=!0,nt[r].exports=t.factory.call(e,n,t.exports,t)||t.exports,nt[r].exports)}}(),nt[t.id]=t,ot++,h.log("module "+t.id),tt.length||ot!==rt||(h.log("past "+(o()-i)+"ms"),h.groupEnd("coolie modules"),Y._execute(),p(a,function(e,t){t.call(n,Y.exports)}))},dt=function(e,t,n){tt.push([e,t,n])};F&&J(Q,!0),e.coolie=n,e.coolie.modules=nt,e.coolie.each=p,e.coolie.getHost=N,e.coolie.getPathJoin=j,e.coolie.getPathDir=_,e.coolie.getCurrentScript=H,e.coolie.getScriptURL=q,e.define=dt,e.define.amd={},e.define.cmd={}}(this);